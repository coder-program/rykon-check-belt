## üìã Guia Completo de Perfis do Sistema Team Cruz

**Data:** 18 de Outubro de 2025
**Vers√£o:** 2.0

---

## üéØ Vis√£o Geral

O sistema Team Cruz implementa **11 perfis diferentes** para controlar o acesso de usu√°rios √†s funcionalidades. Cada perfil tem permiss√µes espec√≠ficas baseadas em sua fun√ß√£o no sistema.

---

## üîê Perfis Principais (OBRIGAT√ìRIOS)

### 1. **MASTER** üëë

- **Nome no DB:** `master`
- **Descri√ß√£o:** Administrador total do sistema
- **Permiss√µes:** TODAS (32+ permiss√µes)
- **Quem usa:** Equipe t√©cnica e administra√ß√£o central da Team Cruz
- **Acesso:**
  - ‚úÖ Acesso irrestrito a todos os m√≥dulos
  - ‚úÖ Criar/editar/excluir qualquer registro
  - ‚úÖ Gerenciar usu√°rios e permiss√µes
  - ‚úÖ Configura√ß√µes do sistema

**Exemplo de usu√°rio:**

```sql
Username: admin
Email: admin@teamcruz.com
Perfil: master
```

---

### 2. **FRANQUEADO** üè¢

- **Nome no DB:** `franqueado`
- **Descri√ß√£o:** Propriet√°rio de franquia
- **Permiss√µes:**
  - ‚úÖ **Franquias:** READ (visualiza suas franquias)
  - ‚úÖ **Unidades:** READ, WRITE, DELETE (gerencia suas unidades)
  - ‚úÖ **Alunos:** READ, WRITE (gerencia alunos)
  - ‚úÖ **Professores:** READ, WRITE (gerencia professores)
  - ‚úÖ **Financeiro:** READ, WRITE (controle financeiro)
  - ‚úÖ **Relat√≥rios:** READ (visualiza relat√≥rios)

**Quem usa:** Propriet√°rios que possuem uma ou mais franquias

**Funcionalidades:**

- Criar e gerenciar unidades/academias
- Contratar e gerenciar professores
- Aprovar matr√≠culas de alunos
- Acompanhar financeiro das unidades
- Gerar relat√≥rios consolidados

---

### 3. **GERENTE DE UNIDADE** üè™

- **Nome no DB:** `gerente_unidade`
- **Descri√ß√£o:** Gerente de academia/unidade
- **Permiss√µes:**
  - ‚úÖ **Unidades:** READ, WRITE (dados operacionais da unidade)
  - ‚úÖ **Alunos:** READ, WRITE (gerencia alunos da unidade)
  - ‚úÖ **Professores:** READ (visualiza professores)
  - ‚úÖ **Financeiro:** READ (visualiza dados financeiros)
  - ‚úÖ **Relat√≥rios:** READ (relat√≥rios da unidade)

**Quem usa:** Gerentes respons√°veis pela opera√ß√£o de uma unidade espec√≠fica

**Funcionalidades:**

- Gerenciar alunos da unidade
- Acompanhar hor√°rios e aulas
- Visualizar escalas de professores
- Consultar indicadores financeiros
- Gerar relat√≥rios operacionais

---

### 4. **PROFESSOR / INSTRUTOR** ü•ã

- **Nome no DB:** `professor` ou `instrutor` (ambos t√™m mesmas permiss√µes)
- **Descri√ß√£o:** Professor/Instrutor de jiu-jitsu
- **Permiss√µes:**
  - ‚úÖ **Alunos:** READ, WRITE (gerencia seus alunos)
  - ‚úÖ **Unidades:** READ (visualiza informa√ß√µes da unidade)

**Quem usa:** Professores que ministram aulas

**Funcionalidades:**

- Registrar presen√ßa dos alunos
- Avaliar evolu√ß√£o dos alunos
- Aprovar gradua√ß√µes (faixas)
- Visualizar hor√°rios de aulas
- Gerenciar turmas

**Importante:** O sistema filtra automaticamente para mostrar apenas alunos das unidades onde o professor ministra aulas.

---

### 5. **ALUNO** üéì

- **Nome no DB:** `aluno`
- **Descri√ß√£o:** Aluno matriculado
- **Permiss√µes:**
  - ‚úÖ **Alunos:** READ (apenas seus pr√≥prios dados)

**Quem usa:** Todos os alunos matriculados

**Funcionalidades:**

- Visualizar hist√≥rico de presen√ßas
- Consultar gradua√ß√£o atual
- Ver pr√≥ximas aulas
- Acompanhar evolu√ß√£o pessoal
- Atualizar dados cadastrais

---

## üìã Perfis Complementares (OPCIONAIS)

### 6. **RECEPCIONISTA** üìû

- **Nome no DB:** `recepcionista`
- **Descri√ß√£o:** Atendimento e check-in
- **Permiss√µes:**
  - ‚úÖ **Alunos:** READ, WRITE (cadastrar e atualizar)
  - ‚úÖ **Unidades:** READ (visualizar informa√ß√µes)
  - ‚úÖ **Professores:** READ (consultar escalas)

**Quem usa:** Atendentes e recepcionistas das academias

**Funcionalidades:**

- Cadastrar novos alunos
- Fazer check-in/registro de presen√ßa
- Atualizar dados cadastrais
- Consultar hor√°rios de aulas
- Atender solicita√ß√µes dos alunos

---

### 7. **FINANCEIRO** üí∞

- **Nome no DB:** `financeiro`
- **Descri√ß√£o:** Gestor financeiro
- **Permiss√µes:**
  - ‚úÖ **Financeiro:** READ, WRITE, ADMIN (controle total)
  - ‚úÖ **Alunos:** READ (consultar dados)
  - ‚úÖ **Unidades:** READ (visualizar informa√ß√µes)
  - ‚úÖ **Relat√≥rios:** READ (relat√≥rios financeiros)

**Quem usa:** Respons√°veis pela √°rea financeira

**Funcionalidades:**

- Controlar mensalidades
- Gerenciar pagamentos
- Emitir cobran√ßas
- Gerar relat√≥rios financeiros
- Controlar inadimpl√™ncia

---

### 8. **COORDENADOR T√âCNICO** üéØ

- **Nome no DB:** `coordenador_tecnico`
- **Descri√ß√£o:** Coordenador de gradua√ß√µes
- **Permiss√µes:**
  - ‚úÖ **Alunos:** READ, WRITE (avaliar gradua√ß√µes)
  - ‚úÖ **Professores:** READ, WRITE (avaliar professores)
  - ‚úÖ **Unidades:** READ (visualizar informa√ß√µes)
  - ‚úÖ **Relat√≥rios:** READ (relat√≥rios t√©cnicos)

**Quem usa:** Coordenadores t√©cnicos respons√°veis por avalia√ß√µes

**Funcionalidades:**

- Aprovar/rejeitar gradua√ß√µes
- Avaliar professores
- Definir crit√©rios de gradua√ß√£o
- Gerar relat√≥rios de evolu√ß√£o
- Acompanhar qualidade t√©cnica

---

### 9. **SUPERVISOR REGIONAL** üåç

- **Nome no DB:** `supervisor_regional`
- **Descri√ß√£o:** Supervisor de m√∫ltiplas unidades
- **Permiss√µes:**
  - ‚úÖ **Unidades:** READ, WRITE (supervisionar m√∫ltiplas)
  - ‚úÖ **Alunos:** READ, WRITE (gerenciar alunos)
  - ‚úÖ **Professores:** READ, WRITE (gerenciar professores)
  - ‚úÖ **Financeiro:** READ (visualizar dados)
  - ‚úÖ **Relat√≥rios:** READ (relat√≥rios regionais)

**Quem usa:** Supervisores respons√°veis por uma regi√£o

**Funcionalidades:**

- Supervisionar m√∫ltiplas unidades
- Avaliar desempenho geral
- Apoiar gerentes locais
- Gerar relat√≥rios consolidados
- Implementar padroniza√ß√µes

---

### 10. **RESPONS√ÅVEL** üë®‚Äçüëß‚Äçüë¶

- **Nome no DB:** `responsavel`
- **Descri√ß√£o:** Respons√°vel legal de menor
- **Permiss√µes:**
  - ‚úÖ **Alunos:** READ (dados dos dependentes)
  - ‚úÖ **Financeiro:** READ (mensalidades)

**Quem usa:** Pais/respons√°veis de alunos menores de idade

**Funcionalidades:**

- Visualizar dados dos filhos/dependentes
- Acompanhar presen√ßas
- Consultar gradua√ß√µes
- Visualizar mensalidades
- Atualizar dados cadastrais

---

### 11. **VISUALIZADOR** üëÅÔ∏è

- **Nome no DB:** `visualizador`
- **Descri√ß√£o:** Acesso somente leitura
- **Permiss√µes:**
  - ‚úÖ TODAS as permiss√µes de READ (apenas visualiza√ß√£o)

**Quem usa:** Auditores, consultores, parceiros

**Funcionalidades:**

- Consultar todos os dados do sistema
- Gerar relat√≥rios
- Exportar dados
- Sem permiss√£o para criar/editar/excluir

---

## üìä Comparativo de Permiss√µes

| M√≥dulo          | Master | Franqueado | Gerente | Professor | Aluno | Recep. | Financ. | Coord. | Superv. | Respons. | Visual. |
| --------------- | ------ | ---------- | ------- | --------- | ----- | ------ | ------- | ------ | ------- | -------- | ------- |
| **Franquias**   | ADMIN  | READ       | -       | -         | -     | -      | -       | -      | -       | -        | READ    |
| **Unidades**    | ADMIN  | RWD        | RW      | R         | -     | R      | R       | R      | RW      | -        | R       |
| **Alunos**      | ADMIN  | RW         | RW      | RW        | R\*   | RW     | R       | RW     | RW      | R\*\*    | R       |
| **Professores** | ADMIN  | RW         | R       | -         | -     | R      | -       | RW     | RW      | -        | R       |
| **Financeiro**  | ADMIN  | RW         | R       | -         | -     | -      | ADMIN   | -      | R       | R\*\*    | R       |
| **Usu√°rios**    | ADMIN  | -          | -       | -         | -     | -      | -       | -      | -       | -        | -       |
| **Relat√≥rios**  | R      | R          | R       | -         | -     | -      | R       | R      | R       | -        | R       |
| **Config.**     | ADMIN  | -          | -       | -         | -     | -      | -       | -      | -       | -        | -       |

**Legenda:**

- **R** = READ (Leitura)
- **W** = WRITE (Escrita)
- **D** = DELETE (Exclus√£o)
- **ADMIN** = Administra√ß√£o total
- **R\*** = Apenas seus pr√≥prios dados
- **R\*\*** = Apenas dados dos dependentes
- **-** = Sem acesso

---

## üöÄ Como Usar os Scripts SQL

### 1. Inserir Perfis

```bash
# No PostgreSQL
psql -U postgres -d teamcruz_db -f backend/insert-perfis-completos.sql
```

### 2. Vincular Permiss√µes aos Perfis

```bash
psql -U postgres -d teamcruz_db -f backend/insert-permissoes-perfis.sql
```

### 3. Criar Usu√°rio e Atribuir Perfil

```sql
-- Exemplo: Criar professor
INSERT INTO teamcruz.usuarios (id, username, email, password, nome, ativo)
VALUES (
  uuid_generate_v4(),
  'joao.silva',
  'joao@teamcruz.com',
  '$2b$10$hashedpassword...',
  'Jo√£o Silva',
  true
);

-- Vincular ao perfil de professor
INSERT INTO teamcruz.usuario_perfis (usuario_id, perfil_id)
VALUES (
  (SELECT id FROM teamcruz.usuarios WHERE username = 'joao.silva'),
  (SELECT id FROM teamcruz.perfis WHERE nome = 'professor')
);
```

---

## üîÑ Fluxo de Cadastro com Perfil

### Via Frontend (Tela de Registro)

```
1. Usu√°rio acessa /register
2. Preenche formul√°rio
3. Seleciona perfil desejado (Aluno, Professor, etc)
4. Sistema:
   - Cria usu√°rio
   - Vincula ao perfil selecionado
   - Marca como "aguardando aprova√ß√£o" (se n√£o for Aluno)
5. Admin aprova em /admin/usuarios-pendentes
6. Usu√°rio pode fazer login com permiss√µes do perfil
```

### Via API

```typescript
POST /api/usuarios
{
  "username": "maria.santos",
  "email": "maria@teamcruz.com",
  "password": "senha123",
  "nome": "Maria Santos",
  "perfil_ids": [
    "uuid-do-perfil-gerente-unidade"
  ]
}
```

---

## üõ°Ô∏è Seguran√ßa e Hierarquia

### N√≠veis de Acesso (do maior para o menor):

1. **Master** ‚Üí Controle total do sistema
2. **Supervisor Regional** ‚Üí M√∫ltiplas unidades
3. **Franqueado** ‚Üí Suas unidades
4. **Coordenador T√©cnico** ‚Üí Avalia√ß√µes t√©cnicas
5. **Gerente Unidade** ‚Üí Uma unidade
6. **Financeiro** ‚Üí Dados financeiros
7. **Professor** ‚Üí Suas turmas
8. **Recepcionista** ‚Üí Atendimento
9. **Respons√°vel** ‚Üí Dados dos dependentes
10. **Aluno** ‚Üí Pr√≥prios dados
11. **Visualizador** ‚Üí Apenas leitura

### Filtros Autom√°ticos por Perfil

O sistema aplica filtros automaticamente:

```typescript
// PROFESSOR v√™ apenas alunos das suas unidades
GET /api/alunos
// SQL: WHERE unidade_id IN (unidades_do_professor)

// FRANQUEADO v√™ apenas suas unidades
GET /api/unidades
// SQL: WHERE franqueado_id = id_do_franqueado

// ALUNO v√™ apenas pr√≥prios dados
GET /api/alunos/:id
// SQL: WHERE id = id_do_usuario_aluno
```

---

## üìå Perfis Recomendados por Cen√°rio

### Cen√°rio 1: Academia Pequena (1 unidade)

- ‚úÖ 1 Master (voc√™)
- ‚úÖ 2-3 Professores
- ‚úÖ 1 Recepcionista
- ‚úÖ N Alunos

### Cen√°rio 2: Rede com Franqueados

- ‚úÖ 1 Master (administra√ß√£o central)
- ‚úÖ 3-5 Franqueados (propriet√°rios)
- ‚úÖ 1 Gerente por unidade
- ‚úÖ 2-4 Professores por unidade
- ‚úÖ 1 Financeiro (central)
- ‚úÖ N Alunos

### Cen√°rio 3: Grande Rede Regional

- ‚úÖ 1 Master
- ‚úÖ 2-3 Supervisores Regionais
- ‚úÖ 5-10 Franqueados
- ‚úÖ 1 Gerente por unidade
- ‚úÖ 1 Coordenador T√©cnico
- ‚úÖ 1-2 Financeiro
- ‚úÖ M√∫ltiplos Professores
- ‚úÖ N Alunos

---

## üìù Pr√≥ximos Passos

1. ‚úÖ Execute `insert-perfis-completos.sql`
2. ‚úÖ Execute `insert-permissoes-perfis.sql`
3. ‚úÖ Crie usu√°rios e vincule aos perfis
4. ‚úÖ Teste login e permiss√µes no frontend
5. ‚úÖ Ajuste permiss√µes conforme necessidade

---

**Criado em:** 18/10/2025
**Atualizado em:** 18/10/2025
**Vers√£o:** 2.0
**Autor:** Team Cruz Development Team
